{% extends "budget/expenses/expense.html" %}

{% block page_title %}Expenses{% endblock page_title %}

{% block main_class %} class="table-content" {% endblock main_class %}

{% block content %}
  <div class="flex mt-2 mb-4">
    <h1 class="imp page-title mr-4">My Expenses</h1>
    <!-- <div class="flex align-center flex-wrap"> -->
    <a href="{% url 'budget:expense_form_page' %}" class="btn btn-outline-primary imp title-med"><i class="fas fa-plus"></i> New Expense</a>
      
    <!-- </div> -->
    
  </div>

  <div class="flex flex-wrap align-center mb-2">
    <span class="title-med imp mr-2">Filters: </span>
    <button type="button" class="btn btn-outline-primary imp title-sm mr-4"><span id="current-month">Month: {{ month }}<i class="fas fa-caret-down"></i></button>
    <form action="" method="POST" class="inline-for flex align-center just-end" enctype="application/x-www-form-urlencoded">        
      {% csrf_token %}
      <!-- <div class="form-group mb-ow row"> -->
        <label for="expense-search" class="sr-only">Search:</label>
        <input type="search" id="expense-search" name="expense-search" class="form-control" aria-describedby="search">
        <button type="submit" class="btn btn-outline-primary form-control"><i class="fas fa-search"></i></button>
      <!-- </div> -->
      
    </form>
  </div>
  
  

  {% if latest_expenses_list %}
  <div class="table-responsive">
    <table class="table table-striped mb-4">
      <thead>
        <tr>
          <th scope="col" class="title-sm">ID</th>
          <th scope="col" class="title-sm">Date</th>
          <th scope="col" class="title-sm">Amount</th>
          <th scope="col" class="title-sm">Category</th>
          <th scope="col" class="title-sm">Vendor</th>
          <th scope="col" class="title-sm">Description</th>
          <th scope="col" class="title-sm">Receipt</th>
        </tr>
      </thead>
      <tbody>
        {% for expense in latest_expenses_list %}
        <tr>
          <td><a href="{% url 'budget:expense_detail' expense.id %}">{{ expense.pk }}</a></td>
          <td>{{ expense.expense_date }}</td>
          <td>${{ expense.amount }}</td>
          <td>{{ expense.category }}</td>
          <td>{{ expense.vendor }}</td>
          <td>{{ expense.description }}</td>
          <td>{% if expense.receipt %} Yes
            {% else %} {% endif %}</td>
        </tr>
        {% endfor %}

        <tr class="table-secondary">
          <td colspan="2" class="imp title-sm">Monthly Total:</td>
          <td colspan="5" class="imp title-sm">${{ monthly_total }}</td>
        </tr>
        
      </tbody>
      

    </table>
    <nav aria-label="..." class="flex just-center">
      <ul class="pagination">

      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
      {% endif %}

{% comment %}
        {% for page in page_obj.page_range %}
        {% endcomment %}
        <li class="page-item"><a class="page-link" href="#">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</a></li>
        {% comment %}
        {% endfor %}
        {% endcomment %}

        {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link ">Next</span>
        </li>
        {% endif %}


        </li>
      </ul>
    </nav>
  </div>
 
  {% else %}
      <p>You don't have any expenses yet!</p>
  {% endif %}
{% endblock content%}